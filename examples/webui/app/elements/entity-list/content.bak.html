<dom-module id="entity-list">
    <style>

    </style>
    <template>
        <iron-ajax  id="get_entity_data"
                    url="data/things.json"
                    last-response="{{data}}"
                    on-response="handleEntityResponse"
                    handleAs="json">
        </iron-ajax>

        <paper-listbox selected="0">
            <template is="dom-repeat" items="{{data}}">
                <paper-item on-tap="tapEntityItem" entity="{{entity}}" entityId="{{item.id}}">
                    <paper-item-body two-line>
                        <div>{{item.name}}</div>
                        <div>id: {{item.id}}</div>
                    </paper-item-body>
                    <paper-ripple></paper-ripple>
                </paper-item>
            </template>
        </paper-listbox>

    </template>
    <script>
        (function() {
            'use strict';
            Polymer({
                is: 'entity-list',
                propertes: {
                    entityUrl: {
                        type: String,
                        computed: "getEntityUrl(entity)"
                    }
                },
                tapEntityItem: function(e, details, sender) {
                    alert(e.currentTarget.getAttribute('entity'));
                    alert(e.currentTarget.getAttribute('entityId'));
                },
                ready: function() {
                    this.$.get_entity_data.url = "data/" + this.entity + ".json";
                    this.$.get_entity_data.generateRequest();
                },
                handleEntityResponse: function(data) {
                    this.$.toast_message.text = "Returned " + data.detail.response.length + " entities";
                    this.$.toast_message.open();
                }
            });
        })();
    </script>
</dom-module>